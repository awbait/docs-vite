import{_ as l,c as p,b as s,t as n,a as e,o}from"./app.852d0fdd.js";const b=JSON.parse('{"title":"Airflow","description":"","frontmatter":{},"headers":[{"level":3,"title":"1. \u041F\u0440\u0435\u0434\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430 \u0431\u0430\u0437\u044B \u0434\u0430\u043D\u043D\u044B\u0445","slug":"_1-\u043F\u0440\u0435\u0434\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-\u0431\u0430\u0437\u044B-\u0434\u0430\u043D\u043D\u044B\u0445","link":"#_1-\u043F\u0440\u0435\u0434\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-\u0431\u0430\u0437\u044B-\u0434\u0430\u043D\u043D\u044B\u0445","children":[]},{"level":3,"title":"2. \u041A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0447\u0430\u0440\u0442\u0430:","slug":"_2-\u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F-\u0447\u0430\u0440\u0442\u0430","link":"#_2-\u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F-\u0447\u0430\u0440\u0442\u0430","children":[]},{"level":3,"title":"3. \u0423\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u0447\u0430\u0440\u0442\u0430:","slug":"_3-\u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430-\u0447\u0430\u0440\u0442\u0430","link":"#_3-\u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430-\u0447\u0430\u0440\u0442\u0430","children":[]},{"level":3,"title":"4. \u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043C\u043E\u0441\u0442\u0435\u0439 \u0438 \u0447\u0430\u0440\u0442\u0430","slug":"_4-\u043E\u0431\u043D\u043E\u0432n\u0435\u043D\u0438\u0435-\u0437\u0430\u0432\u0438\u0441\u0438\u043C\u043E\u0441\u0442\u0435\u0439-\u0438-\u0447\u0430\u0440\u0442\u0430","link":"#_4-\u043E\u0431\u043D\u043E\u0432n\u0435\u043D\u0438\u0435-\u0437\u0430\u0432\u0438\u0441\u0438\u043C\u043E\u0441\u0442\u0435\u0439-\u0438-\u0447\u0430\u0440\u0442\u0430","children":[]},{"level":3,"title":"5. \u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044B\u0439 \u0447\u0430\u0440\u0442","slug":"_5-\u0443\u0434\u0430n\u0438\u0442\u044C-\u0443\u0441\u0442\u0430\u043D\u043E\u0432n\u0435\u043D\u043D\u044B\u0439-\u0447\u0430\u0440\u0442","link":"#_5-\u0443\u0434\u0430n\u0438\u0442\u044C-\u0443\u0441\u0442\u0430\u043D\u043E\u0432n\u0435\u043D\u043D\u044B\u0439-\u0447\u0430\u0440\u0442","children":[]},{"level":3,"title":"6. \u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430 GitSync","slug":"_6-\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-gitsync","link":"#_6-\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-gitsync","children":[]}],"relativePath":"devops/kubernetes/charts/airflow.md","lastUpdated":1665449255000}'),t={name:"devops/kubernetes/charts/airflow.md"},r=e(`<h1 id="airflow" tabindex="-1">Airflow <a class="header-anchor" href="#airflow" aria-hidden="true">#</a></h1><p>\u0421\u043A\u0430\u0447\u0430\u0442\u044C \u043C\u043E\u0439 \u0447\u0430\u0440\u0442:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">wget -O - https://github.com/awbait/infrastructure-as-code/archive/master.tar.gz </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> tar -xz --strip=3 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">infrastructure-as-code-master/kubernetes/charts/deploy-airflow</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><h3 id="_1-\u043F\u0440\u0435\u0434\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-\u0431\u0430\u0437\u044B-\u0434\u0430\u043D\u043D\u044B\u0445" tabindex="-1">1. \u041F\u0440\u0435\u0434\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430 \u0431\u0430\u0437\u044B \u0434\u0430\u043D\u043D\u044B\u0445 <a class="header-anchor" href="#_1-\u043F\u0440\u0435\u0434\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-\u0431\u0430\u0437\u044B-\u0434\u0430\u043D\u043D\u044B\u0445" aria-hidden="true">#</a></h3><p>\u0421\u043E\u0437\u0434\u0430\u0451\u043C \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F \u0438 \u0431\u0430\u0437\u0443 \u0434\u0430\u043D\u043D\u044B\u0445:</p><div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> USER airflow </span><span style="color:#F78C6C;">WITH</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">PASSWORD</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">airflow</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">login</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">DATABASE</span><span style="color:#A6ACCD;"> airflow </span><span style="color:#F78C6C;">with</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">owner</span><span style="color:#A6ACCD;"> airflow;</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">SCHEMA</span><span style="color:#A6ACCD;"> airflow AUTHORIZATION airflow;</span></span>
<span class="line"></span></code></pre></div><h3 id="_2-\u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F-\u0447\u0430\u0440\u0442\u0430" tabindex="-1">2. \u041A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0447\u0430\u0440\u0442\u0430: <a class="header-anchor" href="#_2-\u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F-\u0447\u0430\u0440\u0442\u0430" aria-hidden="true">#</a></h3><p>\u0422\u0430\u043A \u043A\u0430\u043A \u0440\u0435\u043F\u043E\u0437\u0438\u0442\u043E\u0440\u0438\u044F \u043D\u0430 github&#39;e \u043E\u0444\u0438\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0433\u043E \u0447\u0430\u0440\u0442\u0430 \u044F \u043D\u0435 \u043D\u0430\u0448\u0435\u043B. \u041F\u0440\u0438\u0448\u043B\u043E\u0441\u044C \u0441\u043A\u0430\u0447\u0430\u0442\u044C \u0432\u0441\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F \u0447\u0430\u0440\u0442\u0430 \u0447\u0435\u0440\u0435\u0437 \u043A\u043E\u043C\u0430\u043D\u0434\u0443 (\u0434\u0430\u043D\u043D\u044B\u0439 \u0444\u0430\u0439\u043B\u0438\u043A \u0443\u0436\u0435 \u0438\u043C\u0435\u0435\u0442\u0441\u044F \u0432 \u043C\u043E\u0451\u043C \u0447\u0430\u0440\u0442\u0435):</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">helm show values apache-airflow/airflow </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> values.yaml.example</span></span>
<span class="line"></span></code></pre></div><p>\u0412 \u0444\u0430\u0439\u043B\u0435 values.yaml \u043C\u043E\u0436\u043D\u043E \u0438\u0437\u043C\u0435\u043D\u044F\u0442\u044C \u0440\u0430\u0437\u043B\u0438\u0447\u043D\u044B\u0435 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u0447\u0430\u0440\u0442\u0430.</p><h4 id="\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-\u043F\u043E\u0434\u043An\u044E\u0447\u0435\u043D\u0438\u044F-\u043A-\u0431\u0430\u0437\u0435-\u0434\u0430\u043D\u043D\u044B\u0445" tabindex="-1">\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430 \u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u044F \u043A \u0431\u0430\u0437\u0435 \u0434\u0430\u043D\u043D\u044B\u0445 <a class="header-anchor" href="#\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-\u043F\u043E\u0434\u043An\u044E\u0447\u0435\u043D\u0438\u044F-\u043A-\u0431\u0430\u0437\u0435-\u0434\u0430\u043D\u043D\u044B\u0445" aria-hidden="true">#</a></h4><p>\u0412 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0445 \u0444\u0430\u0439\u043B\u0430\u0445 \u043C\u043E\u0436\u043D\u043E \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0441\u0442\u0440\u043E\u043A\u0438 \u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u044F \u043A \u0432\u043D\u0435\u0448\u043D\u0435\u0439 \u0431\u0430\u0437\u0435 \u0434\u0430\u043D\u043D\u044B\u0445 \u043F\u043E \u0448\u0430\u0431\u043B\u043E\u043D\u0443: templates/database-credentials.yaml</p>`,12),c=s("p",null,"templates/database-backend-credentials.yaml",-1),i=e(`<h4 id="\u0441\u0435\u043A\u0440\u0435\u0442\u043D\u044B\u0439-\u043An\u044E\u0447" tabindex="-1">\u0421\u0435\u043A\u0440\u0435\u0442\u043D\u044B\u0439 \u043A\u043B\u044E\u0447 <a class="header-anchor" href="#\u0441\u0435\u043A\u0440\u0435\u0442\u043D\u044B\u0439-\u043An\u044E\u0447" aria-hidden="true">#</a></h4><p>\u0414\u0430\u043B\u0435\u0435 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0441\u0433\u0435\u043D\u0435\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441\u0435\u043A\u0440\u0435\u0442\u043D\u044B\u0439 \u043A\u043B\u044E\u0447 \u043A\u043E\u043C\u0430\u043D\u0434\u043E\u0439:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">python3 -c </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">import secrets; print(secrets.token_hex(16))</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> base64</span></span>
<span class="line"></span></code></pre></div><p>\u041A\u043E\u043F\u0438\u0440\u0443\u0435\u043C \u0438 \u0437\u0430\u043C\u0435\u043D\u044F\u0435\u043C \u0441\u043E\u0434\u0435\u0440\u0436\u0438\u043C\u043E\u0435 \u0432 \u0444\u0430\u0439\u043B\u0435: templates/airflow-webserver-secret.yaml</p><div class="language-yaml"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">webserver-secret-key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">YOUR_SECRET_KEY</span></span>
<span class="line"></span></code></pre></div><h4 id="\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-ingress" tabindex="-1">\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430 Ingress <a class="header-anchor" href="#\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-ingress" aria-hidden="true">#</a></h4><p>\u0412 \u0441\u0432\u043E\u0451\u043C \u043F\u0440\u0438\u043C\u0435\u0440\u0435 \u044F \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u044E \u043E\u0434\u043D\u043E\u043D\u043E\u0434\u043E\u0432\u044B\u0439 k3s \u043A\u043B\u0430\u0441\u0442\u0435\u0440, \u0432 \u043A\u043E\u0442\u043E\u0440\u043E\u043C \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E \u0438\u0434\u0435\u0442 \u043E\u0431\u0440\u0430\u0442\u043D\u044B\u0439 \u043F\u0440\u043E\u043A\u0441\u0438 \u0441\u0435\u0440\u0432\u0435\u0440 \u0441 \u043B\u043E\u0430\u0434\u0431\u0430\u043B\u0430\u043D\u0441\u0435\u0440\u043E\u043C - traefik.</p><p>\u0414\u043B\u044F \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E\u0433\u043E \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u044B \u043D\u0435 \u043D\u0430 root \u043F\u0443\u0442\u0438, \u0430 \u043D\u0430 /airflow \u0438 /flower \u043C\u043D\u0435 \u043F\u0440\u0438\u0448\u043B\u043E\u0441\u044C \u0441\u043E\u0437\u0434\u0430\u0442\u044C 2 middleware: ingress-airflow-middleware.yaml \u0438 ingress-flower-middleware.yaml</p><p>\u0418 \u0432\u043A\u043B\u044E\u0447\u0438\u0442\u044C \u0438\u0445 \u0432 Ingress-\u043A\u043B\u0430\u0441\u0441\u0430\u0445 \u0447\u0435\u0440\u0435\u0437 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0438\u0445 \u0432 \u0430\u043D\u043D\u043E\u0442\u0430\u0446\u0438\u0438.</p><p>\u041F\u043E\u044D\u0442\u043E\u043C\u0443 \u0435\u0441\u043B\u0438 \u0432\u0430\u043C \u044D\u0442\u043E \u043D\u0435 \u043D\u0443\u0436\u043D\u043E, \u043E\u0442\u0440\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0444\u0430\u0439\u043B values.yaml \u0438 \u0443\u0434\u0430\u043B\u0438\u0442\u0435 \u044D\u0442\u0438 \u0434\u0432\u0430 \u0444\u0430\u0439\u043B\u0430 \u0432 \u043F\u0430\u043F\u043A\u0435 templates.</p><p><a href="./../hacks/traefik-stripprefix">traefik-stripprefix.md</a></p><h3 id="_3-\u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430-\u0447\u0430\u0440\u0442\u0430" tabindex="-1">3. \u0423\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u0447\u0430\u0440\u0442\u0430: <a class="header-anchor" href="#_3-\u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430-\u0447\u0430\u0440\u0442\u0430" aria-hidden="true">#</a></h3><p>!!! note \u0412 \u0434\u0430\u043D\u043D\u043E\u0439 \u043A\u043E\u043C\u0430\u043D\u0434\u0435 \u043C\u044B \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u043C \u0434\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0445 \u0434\u0432\u0430 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u0430 \u0434\u043B\u044F \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E\u0433\u043E \u0434\u0435\u043F\u043B\u043E\u044F</p><p>\u0423\u0441\u0442\u0430\u043D\u0430\u0432\u043B\u0438\u0432\u0430\u0435\u043C \u0447\u0430\u0440\u0442:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">helm install airflow deploy-airflow/ -n airflow --create-namespace --debug --timeout=10m</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-\u043E\u0431\u043D\u043E\u0432n\u0435\u043D\u0438\u0435-\u0437\u0430\u0432\u0438\u0441\u0438\u043C\u043E\u0441\u0442\u0435\u0439-\u0438-\u0447\u0430\u0440\u0442\u0430" tabindex="-1">4. \u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043C\u043E\u0441\u0442\u0435\u0439 \u0438 \u0447\u0430\u0440\u0442\u0430 <a class="header-anchor" href="#_4-\u043E\u0431\u043D\u043E\u0432n\u0435\u043D\u0438\u0435-\u0437\u0430\u0432\u0438\u0441\u0438\u043C\u043E\u0441\u0442\u0435\u0439-\u0438-\u0447\u0430\u0440\u0442\u0430" aria-hidden="true">#</a></h3><p>\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043C\u043E\u0441\u0442\u0435\u0439 \u0447\u0430\u0440\u0442\u0430:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">helm dependency update deploy-airflow/</span></span>
<span class="line"></span></code></pre></div><p>\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u0447\u0430\u0440\u0442\u0430:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">helm upgrade airflow deploy-airflow/ -n airflow</span></span>
<span class="line"></span></code></pre></div><h3 id="_5-\u0443\u0434\u0430n\u0438\u0442\u044C-\u0443\u0441\u0442\u0430\u043D\u043E\u0432n\u0435\u043D\u043D\u044B\u0439-\u0447\u0430\u0440\u0442" tabindex="-1">5. \u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044B\u0439 \u0447\u0430\u0440\u0442 <a class="header-anchor" href="#_5-\u0443\u0434\u0430n\u0438\u0442\u044C-\u0443\u0441\u0442\u0430\u043D\u043E\u0432n\u0435\u043D\u043D\u044B\u0439-\u0447\u0430\u0440\u0442" aria-hidden="true">#</a></h3><p>\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044B\u0439 \u0447\u0430\u0440\u0442:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">helm delete airflow -n airflow</span></span>
<span class="line"></span></code></pre></div><h3 id="_6-\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-gitsync" tabindex="-1">6. \u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430 GitSync <a class="header-anchor" href="#_6-\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-gitsync" aria-hidden="true">#</a></h3><h4 id="\u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0435-\u043F\u0440\u0438\u0432\u0430\u0442\u043D\u043E\u0433\u043E-\u0440\u0435\u043F\u043E\u0437\u0438\u0442\u043E\u0440\u0438\u044F-\u0438-\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-\u043F\u043E\u0434\u043An\u044E\u0447\u0435\u043D\u0438\u044F-\u043A-\u043D\u0435\u043C\u0443" tabindex="-1">\u0421\u043E\u0437\u0434\u0430\u043D\u0438\u0435 \u043F\u0440\u0438\u0432\u0430\u0442\u043D\u043E\u0433\u043E \u0440\u0435\u043F\u043E\u0437\u0438\u0442\u043E\u0440\u0438\u044F \u0438 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430 \u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u044F \u043A \u043D\u0435\u043C\u0443 <a class="header-anchor" href="#\u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0435-\u043F\u0440\u0438\u0432\u0430\u0442\u043D\u043E\u0433\u043E-\u0440\u0435\u043F\u043E\u0437\u0438\u0442\u043E\u0440\u0438\u044F-\u0438-\u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430-\u043F\u043E\u0434\u043An\u044E\u0447\u0435\u043D\u0438\u044F-\u043A-\u043D\u0435\u043C\u0443" aria-hidden="true">#</a></h4><p>\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0441\u043E\u0437\u0434\u0430\u0435\u043C \u043F\u0440\u0438\u0432\u0430\u0442\u043D\u044B\u0439 \u0440\u0435\u043F\u043E\u0437\u0438\u0442\u043E\u0440\u0438\u0439. \u0414\u0430\u043B\u0435\u0435 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0441\u0433\u0435\u043D\u0435\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C SSH \u043A\u043B\u044E\u0447 \u0447\u0442\u043E\u0431\u044B \u043D\u0430\u0441\u0442\u0440\u043E\u0438\u0442\u044C \u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435 \u043A \u043D\u0430\u0448\u0435\u043C\u0443 \u0440\u0435\u043F\u043E\u0437\u0438\u0442\u043E\u0440\u0438\u044E \u043F\u043E SSH.</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">ssh-keygen -t rsa -b 4096 -C </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">your_email@example.com</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><h5 id="\u0434\u043E\u0431\u0430\u0432n\u044F\u0435\u043C-\u043F\u0443\u0431n\u0438\u0447\u043D\u044B\u0439-\u043An\u044E\u0447-\u043A-\u043D\u0430\u0448\u0435\u043C\u0443-\u0440\u0435\u043F\u043E\u0437\u0438\u0442\u043E\u0440\u0438\u044E" tabindex="-1">\u0414\u043E\u0431\u0430\u0432\u043B\u044F\u0435\u043C \u043F\u0443\u0431\u043B\u0438\u0447\u043D\u044B\u0439 \u043A\u043B\u044E\u0447 \u043A \u043D\u0430\u0448\u0435\u043C\u0443 \u0440\u0435\u043F\u043E\u0437\u0438\u0442\u043E\u0440\u0438\u044E <a class="header-anchor" href="#\u0434\u043E\u0431\u0430\u0432n\u044F\u0435\u043C-\u043F\u0443\u0431n\u0438\u0447\u043D\u044B\u0439-\u043An\u044E\u0447-\u043A-\u043D\u0430\u0448\u0435\u043C\u0443-\u0440\u0435\u043F\u043E\u0437\u0438\u0442\u043E\u0440\u0438\u044E" aria-hidden="true">#</a></h5><p>\u041A\u043B\u044E\u0447 \u043E\u0431\u044B\u0447\u043D\u043E \u043D\u0430\u0445\u043E\u0434\u0438\u0442\u0441\u044F \u043F\u043E \u043F\u0443\u0442\u0438: <code>~/.ssh/id_rsa.pub</code></p><p>\u0412\u044B\u0432\u043E\u0434\u0438\u043C \u043D\u0430 \u044D\u043A\u0440\u0430\u043D \u0438 \u043A\u043E\u043F\u0438\u0440\u0443\u0435\u043C:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">cat </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/.ssh/id_rsa.pub</span></span>
<span class="line"></span></code></pre></div><p>\u042F \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u044E GitLab \u043F\u043E\u044D\u0442\u043E\u043C\u0443 \u043E\u0442\u043A\u0440\u044B\u0432\u0430\u044E \u0440\u0435\u043F\u043E\u0437\u0438\u0442\u043E\u0440\u0438\u0439 -&gt; Settings -&gt; Repository -&gt; Deploy Keys \u0438 \u0434\u043E\u0431\u0430\u0432\u043B\u044F\u044E \u043D\u0430\u0448 \u043A\u043B\u044E\u0447.</p><p>\u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044C \u0447\u0442\u043E \u0433\u0430\u043B\u043E\u0447\u043A\u0430 &quot;\u0434\u043B\u044F \u0437\u0430\u043F\u0438\u0441\u0438&quot; \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u0430.</p><h5 id="\u0440\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u0443\u0435\u043C-\u0438-\u0441\u043E\u0437\u0434\u0430\u0451\u043C-secret-\u0432-kubernetes" tabindex="-1">\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u0443\u0435\u043C \u0438 \u0441\u043E\u0437\u0434\u0430\u0451\u043C secret \u0432 Kubernetes <a class="header-anchor" href="#\u0440\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u0443\u0435\u043C-\u0438-\u0441\u043E\u0437\u0434\u0430\u0451\u043C-secret-\u0432-kubernetes" aria-hidden="true">#</a></h5><p>\u0410\u043D\u0430\u043B\u043E\u0433\u0438\u0447\u043D\u044B\u043C \u043C\u0435\u0442\u043E\u0434\u043E\u043C \u043A\u043E\u043F\u0438\u0440\u0443\u0435\u043C \u043F\u0440\u0438\u0432\u0430\u0442\u043D\u044B\u0439 \u043A\u043B\u044E\u0447 \u0438\u0437 \u0444\u0430\u0439\u043B\u0430 <code>~/.ssh/id_rsa</code> \u043A\u043E\u043C\u0430\u043D\u0434\u043E\u0439:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">cat </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/.ssh/id_rsa </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> base64</span></span>
<span class="line"></span></code></pre></div><p>\u041A\u043E\u043F\u0438\u0440\u0443\u0435\u043C \u0441\u043E\u0434\u0435\u0440\u0436\u0438\u043C\u043E\u0435 \u0438 \u0432\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u043C \u0432 \u0444\u0430\u0439\u043B: templates/airflow-ssh-secret.yaml</p><div class="language-yaml"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">gitSshKey</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">&lt;YOUR_PRIVATE_KEY_IN_BASE64&gt;</span></span>
<span class="line"></span></code></pre></div><h5 id="\u0440\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u0443\u0435\u043C-\u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044E-\u0447\u0430\u0440\u0442\u0430" tabindex="-1">\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u0443\u0435\u043C \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044E \u0447\u0430\u0440\u0442\u0430 <a class="header-anchor" href="#\u0440\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u0443\u0435\u043C-\u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044E-\u0447\u0430\u0440\u0442\u0430" aria-hidden="true">#</a></h5><p>values.yaml</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">dags:</span></span>
<span class="line"><span style="color:#A6ACCD;">  gitSync:</span></span>
<span class="line"><span style="color:#A6ACCD;">    enabled: true</span></span>
<span class="line"><span style="color:#A6ACCD;">    repo: ssh://git@domain.ru/progect-name/repo-name.git</span></span>
<span class="line"><span style="color:#A6ACCD;">    branch: main</span></span>
<span class="line"><span style="color:#A6ACCD;">    rev: HEAD</span></span>
<span class="line"><span style="color:#A6ACCD;">    maxFailures: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">    subPath: &quot;dags&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    sshKeySecret: airflow-ssh-secret</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u041E\u0431\u043D\u043E\u0432\u043B\u044F\u0435\u043C \u0447\u0430\u0440\u0442 \u043A\u043E\u043C\u0430\u043D\u0434\u043E\u0439 \u0438\u0437 \u043F.4</p><p>\u0413\u043E\u0442\u043E\u0432\u043E.</p><h4 id="_7-\u0434\u043E\u043F\u043En\u043D\u0438\u0442\u0435n\u044C\u043D\u043E" tabindex="-1">7. \u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u043E <a class="header-anchor" href="#_7-\u0434\u043E\u043F\u043En\u043D\u0438\u0442\u0435n\u044C\u043D\u043E" aria-hidden="true">#</a></h4><p>\u0414\u043B\u044F \u0432\u0437\u0430\u0438\u043C\u043E\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F \u0441 Camunda \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u0443\u044E:</p><div class="language-yaml"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#F07178;">env</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">AIRFLOW__API__AUTH_BACKEND</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">airflow.api.auth.backend.basic_auth</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>\u0414\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430\u0446\u0438\u044F \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u0430: <a href="https://airflow.apache.org/docs/apache-airflow/stable/security/api.html" target="_blank" rel="noreferrer">https://airflow.apache.org/docs/apache-airflow/stable/security/api.html</a></p>`,47);function d(a,h,y,C,u,A){return o(),p("div",null,[r,s("pre",null,[s("code",null,"``` yaml\nconnection: "+n("postgresql://user:pass@host:5432/db?sslmode=disable"|a.b64enc)+"\n```\n",1)]),c,s("pre",null,[s("code",null,"``` yaml\nconnection: "+n("db+postgresql://user:pass@host:5432/db?sslmode=disable"|a.b64enc)+"\n```\n",1)]),i])}const g=l(t,[["render",d]]);export{b as __pageData,g as default};

import{_ as s,c as a,o as n,a as e}from"./app.852d0fdd.js";const b=JSON.parse('{"title":"bare-metall k8s cluster","description":"","frontmatter":{},"headers":[{"level":3,"title":"\u0418\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F \u043A\u043B\u0430\u0441\u0442\u0435\u0440\u0430:","slug":"\u0438\u043D\u0438\u0446\u0438\u0430n\u0438\u0437\u0430\u0446\u0438\u044F-\u043An\u0430\u0441\u0442\u0435\u0440\u0430","link":"#\u0438\u043D\u0438\u0446\u0438\u0430n\u0438\u0437\u0430\u0446\u0438\u044F-\u043An\u0430\u0441\u0442\u0435\u0440\u0430","children":[]},{"level":3,"title":"\u0423\u0441\u0442\u0430\u043D\u0430\u0432\u043B\u0438\u0432\u0430\u0435\u043C Network-plugin:","slug":"\u0443\u0441\u0442\u0430\u043D\u0430\u0432n\u0438\u0432\u0430\u0435\u043C-network-plugin","link":"#\u0443\u0441\u0442\u0430\u043D\u0430\u0432n\u0438\u0432\u0430\u0435\u043C-network-plugin","children":[]},{"level":3,"title":"\u041F\u043E\u0434\u043A\u043B\u044E\u0447\u0430\u0435\u043C worker-\u0443\u0437\u043B\u044B","slug":"\u043F\u043E\u0434\u043An\u044E\u0447\u0430\u0435\u043C-worker-\u0443\u0437n\u044B","link":"#\u043F\u043E\u0434\u043An\u044E\u0447\u0430\u0435\u043C-worker-\u0443\u0437n\u044B","children":[]}],"relativePath":"devops/kubernetes/configs/bare-metall-k8s-cluster.md","lastUpdated":1665449255000}'),l={name:"devops/kubernetes/configs/bare-metall-k8s-cluster.md"},p=e(`<h1 id="bare-metall-k8s-cluster" tabindex="-1">bare-metall k8s cluster <a class="header-anchor" href="#bare-metall-k8s-cluster" aria-hidden="true">#</a></h1><h3 id="\u0438\u043D\u0438\u0446\u0438\u0430n\u0438\u0437\u0430\u0446\u0438\u044F-\u043An\u0430\u0441\u0442\u0435\u0440\u0430" tabindex="-1">\u0418\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F \u043A\u043B\u0430\u0441\u0442\u0435\u0440\u0430: <a class="header-anchor" href="#\u0438\u043D\u0438\u0446\u0438\u0430n\u0438\u0437\u0430\u0446\u0438\u044F-\u043An\u0430\u0441\u0442\u0435\u0440\u0430" aria-hidden="true">#</a></h3><p>\u0418\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0438\u0440\u0443\u0435\u043C \u043D\u0430 master-\u0443\u0437\u043B\u0435:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">kubeadm init --apiserver-advertise-address=</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">MASTER_IP</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> --pod-network-cidr=10.100.0.0/16</span></span>
<span class="line"></span></code></pre></div><p>\u041F\u043E \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044E \u043A\u043E\u043C\u0430\u043D\u0434\u044B, \u043F\u043E\u043B\u0443\u0447\u0438\u043C \u043A\u043E\u043C\u0430\u043D\u0434\u0443 \u0432 \u0432\u0438\u0434\u0435:</p><p><code>kubeadm join &lt;MASTER\\_IP&gt;:&lt;PORT&gt; --token 38i2yk.nsges1b5btqnzk4j4 \\ --discovery-token-ca-cert-hash sha256:6e84b5587af506009db7ab07de8142d5e6869b0186d932dd729601d2729a880f</code></p><p>\u0421\u043A\u043E\u043F\u0438\u0440\u0443\u0435\u043C \u0438 \u0441\u043E\u0445\u0440\u0430\u043D\u044F\u0435\u043C, \u043E\u043D\u0430 \u043D\u0430\u043C \u043F\u043E\u043D\u0430\u0434\u043E\u0431\u0438\u0442\u0441\u044F \u0434\u0430\u043B\u044C\u0448\u0435</p><p>\u0422\u0430\u043A \u0436\u0435 \u043D\u0430 master-\u0443\u0437\u043B\u0435 \u043F\u0440\u043E\u043F\u0438\u0441\u044B\u0432\u0430\u0435\u043C \u043A\u043E\u043C\u0430\u043D\u0434\u044B:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">mkdir -p </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">HOME/.kube</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo cp -i /etc/kubernetes/admin.conf </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">HOME/.kube/config</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo chown </span><span style="color:#89DDFF;">$(</span><span style="color:#C3E88D;">id -u</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">:</span><span style="color:#89DDFF;">$(</span><span style="color:#C3E88D;">id -g</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">HOME/.kube/config</span></span>
<span class="line"></span></code></pre></div><h3 id="\u0443\u0441\u0442\u0430\u043D\u0430\u0432n\u0438\u0432\u0430\u0435\u043C-network-plugin" tabindex="-1">\u0423\u0441\u0442\u0430\u043D\u0430\u0432\u043B\u0438\u0432\u0430\u0435\u043C Network-plugin: <a class="header-anchor" href="#\u0443\u0441\u0442\u0430\u043D\u0430\u0432n\u0438\u0432\u0430\u0435\u043C-network-plugin" aria-hidden="true">#</a></h3><p>\u0421\u043A\u0430\u0447\u0438\u0432\u0430\u0435\u043C \u043A\u043E\u043D\u0444\u0438\u0433:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">curl https://projectcalico.docs.tigera.io/manifests/calico.yaml -O</span></span>
<span class="line"></span></code></pre></div><p>\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u0443\u0435\u043C \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043E\u043D\u043D\u044B\u0439 \u0444\u0430\u0439\u043B, \u043D\u0430\u0445\u043E\u0434\u0438\u043C \u0441\u0442\u0440\u043E\u0447\u043A\u0438 \u0443\u043A\u0430\u0437\u0430\u043D\u043D\u044B\u0435 \u043D\u0438\u0436\u0435 \u0440\u0430\u0441\u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0438\u0440\u0443\u0435\u043C \u0438\u0445 \u0438 \u0437\u0430\u043C\u0435\u043D\u044F\u0435\u043C \u043F\u0443\u043B ip-\u0430\u0434\u0440\u0435\u0441\u043E\u0432 \u043D\u0430 \u0442\u043E\u0442 \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u0443\u043A\u0430\u0437\u044B\u0432\u0430\u043B\u0438 \u0440\u0430\u043D\u0435\u0435 \u043F\u0440\u0438 \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u0438 \u043A\u043B\u0430\u0441\u0442\u0435\u0440\u0430 \u0432 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u0435 (pod-network-cidr) calico.yaml</p><div class="language-yaml"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">CALICO_IPV4POOL_CIDR</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">10.100.0.0/16</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C \u043A\u043E\u043D\u0444\u0438\u0433:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">kubectl apply -f calico.yaml</span></span>
<span class="line"></span></code></pre></div><h3 id="\u043F\u043E\u0434\u043An\u044E\u0447\u0430\u0435\u043C-worker-\u0443\u0437n\u044B" tabindex="-1">\u041F\u043E\u0434\u043A\u043B\u044E\u0447\u0430\u0435\u043C worker-\u0443\u0437\u043B\u044B <a class="header-anchor" href="#\u043F\u043E\u0434\u043An\u044E\u0447\u0430\u0435\u043C-worker-\u0443\u0437n\u044B" aria-hidden="true">#</a></h3><p>\u041C\u043E\u0436\u043D\u043E \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u044C \u043A\u043E\u043C\u0430\u043D\u0434\u0443 \u043A\u043E\u0442\u043E\u0440\u0443\u044E \u043C\u044B \u043F\u043E\u043B\u0443\u0447\u0438\u043B\u0438 \u0432 \u043F\u0435\u0440\u0432\u043E\u043C \u0448\u0430\u0433\u0435.</p><p>\u0418\u043B\u0438 \u043C\u043E\u0436\u0435\u043C \u0437\u0430\u043F\u0440\u043E\u0441\u0438\u0442\u044C \u0435\u0451 \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">kubeadm token create --print-join-command</span></span>
<span class="line"></span></code></pre></div><p>\u041F\u0440\u0438 \u0432\u043E\u0437\u043D\u0438\u043A\u043D\u043E\u0432\u0435\u043D\u0438\u0438 \u043E\u0448\u0438\u0431\u043A\u0438 \u0441 bridge-nf-call-iptables \u0432\u0432\u043E\u0434\u0438\u043C \u043A\u043E\u043C\u0430\u043D\u0434\u0443:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> /proc/sys/net/bridge/bridge-nf-call-iptables</span></span>
<span class="line"></span></code></pre></div><p>\u041D\u0430\u0437\u043D\u0430\u0447\u0430\u0435\u043C \u0440\u043E\u043B\u044C worker-\u0443\u0437\u043B\u0443:</p><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">kubectl label node </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">HOSTNAME_WORKER</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> node-role.kubernetes.io/worker=worker</span></span>
<span class="line"></span></code></pre></div>`,24),o=[p];function t(c,r,i,d,D,y){return n(),a("div",null,o)}const C=s(l,[["render",t]]);export{b as __pageData,C as default};
